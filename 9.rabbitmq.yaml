- name : setting up rabbitmq
  hosts : rabbitmq
  become : yes
  tasks :
    - name : copying rabbitmq repo
      ansible.builtin.copy:
        src : rabbitmq.repo
        dest : /etc/yum.repos.d/rabbitmq.repo
    
    - name : installing rabbitmq server
      ansible.builtin.package:
        name : rabbitmq-server
        state: present
    
    - name : starting and enabling rabbitmq
      ansible.builtin.service:
        name : rabbitmq-server
        enabled : yes
        state : started

    
    - name: adding user and providing permissions
      community.rabbitmq.rabbitmq_user:
        user: roboshop 
        password: roboshop123
        permissions:
        - vhost: /
          configure_priv: .*
          read_priv: .*
          write_priv: .*
        state: present
        
